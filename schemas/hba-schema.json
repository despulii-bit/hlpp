{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "HBA Product List Schema",
  "description": "A schema for a list of Host Bus Adapters (HBAs) and their detailed specifications.",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "vendor",
      "model",
      "description",
      "store_code",
      "product_id",
      "product_name",
      "specs"
    ],
    "properties": {
      "vendor": {
        "type": "string",
        "description": "The manufacturer of the HBA."
      },
      "model": {
        "type": "string",
        "description": "The specific model name of the HBA."
      },
      "description": {
        "type": "string",
        "description": "A brief description of the product."
      },
      "store_code": {
        "type": "string",
        "description": "A code identifying the store where the product is listed (e.g., amazon-us, ebay-us).",
        "pattern": "^[a-z]+-[a-z]{2}$"
      },
      "product_id": {
        "type": "string",
        "description": "The unique identifier for the product on the store's website."
      },
      "product_name": {
        "type": "string",
        "description": "The name of the product as listed on the store's website."
      },
      "specs": {
        "type": "object",
        "required": [
          "controller_mode",
          "operating_mode",
          "pcie",
          "connectors",
          "data_rate",
          "controller",
          "form_factor"
        ],
        "properties": {
          "controller_mode": {
            "type": "string",
            "description": "The mode of the controller, e.g., SAS, FC, or CNA."
          },
          "operating_mode": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The operating modes supported by the HBA, such as IT or IR."
          },
          "pcie": {
            "type": "object",
            "required": ["generation", "lanes", "throughput_mb_s"],
            "properties": {
              "generation": {
                "type": "number",
                "description": "The PCIe generation, e.g., 2.0 or 3.0."
              },
              "lanes": {
                "type": "string",
                "description": "The number of PCIe lanes, e.g., x8.",
                "pattern": "^x\\d+$"
              },
              "throughput_mb_s": {
                "type": "number",
                "description": "PCIe data burst transfer rate in MB/s."
              }
            }
          },
          "connectors": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["type", "location", "lanes", "count"],
              "properties": {
                "type": {
                  "type": "string",
                  "description": "The type of connector, e.g., SFF-8087."
                },
                "location": {
                  "type": "string",
                  "enum": ["internal", "external"],
                  "description": "The location of the connector (internal or external)."
                },
                "lanes": {
                  "type": "number",
                  "description": "Number of lanes per connector."
                },
                "count": {
                  "type": "number",
                  "description": "The number of connectors of this type on the card."
                }
              }
            }
          },
          "data_rate": {
            "type": "string",
            "description": "The data transfer rate per port, e.g., 6Gb/s."
          },
          "bandwidth": {
            "type": "object",
            "properties": {
              "per_lane_mb_s": {
                "type": "number",
                "description": "SAS bandwidth per lane in MB/s."
              }
            }
          },
          "controller": {
            "type": "string",
            "description": "The specific controller chip used on the card."
          },
          "chipset": {
            "type": "string",
            "description": "The specific chipset of the controller."
          },
          "form_factor": {
            "type": "string",
            "description": "The physical form factor of the card, e.g., Low Profile."
          },
          "dimensions": {
            "type": "object",
            "properties": {
              "length_inches": {
                "type": "number",
                "description": "The length of the card in inches."
              },
              "width_inches": {
                "type": "number",
                "description": "The width of the card in inches."
              }
            }
          },
          "brackets_included": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The types of mounting brackets included with the card."
          },
          "cable_support": {
            "type": "string",
            "description": "The type of cable supported by the connectors, e.g., Passive Copper."
          },
          "operating_voltage": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The operating voltage required for the card."
          },
          "power_consumption": {
            "type": "object",
            "properties": {
              "nominal_watts": {
                "type": "number",
                "description": "Nominal power consumption in watts."
              },
              "required_airflow_lfm": {
                "type": "number",
                "description": "Required airflow for cooling in LFM."
              }
            }
          },
          "device_support": {
            "type": "object",
            "properties": {
              "max_devices": {
                "type": "number",
                "description": "Maximum number of devices supported."
              },
              "types": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "The types of devices supported, e.g., SAS/SATA."
              }
            }
          },
          "raid_support": {
            "type": "string",
            "description": "Whether the card supports Integrated RAID (IR) or is IT mode."
          },
          "firmware_details": {
            "type": "object",
            "properties": {
              "mode_firmware_version": {
                "type": "string",
                "description": "The firmware version flashed onto the card."
              },
              "bios_rom_version": {
                "type": "string",
                "description": "The BIOS ROM version."
              },
              "uefi_rom_version": {
                "type": "string",
                "description": "The UEFI ROM version."
              }
            }
          },
          "cooling": {
            "type": "string",
            "description": "The cooling method used."
          },
          "environmental": {
            "type": "object",
            "properties": {
              "operating_temperature_c": {
                "type": "object",
                "required": ["min", "max"],
                "properties": {
                  "min": {
                    "type": "number"
                  },
                  "max": {
                    "type": "number"
                  }
                }
              },
              "storage_temperature_c": {
                "type": "object",
                "required": ["min", "max"],
                "properties": {
                  "min": {
                    "type": "number"
                  },
                  "max": {
                    "type": "number"
                  }
                }
              },
              "humidity": {
                "type": "string",
                "description": "Operating humidity range."
              }
            }
          },
          "mtbf": {
            "type": "string",
            "description": "Mean Time Between Failures."
          },
          "regulatory_certifications": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of regulatory certifications."
          },
          "operating_system_support": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of supported operating systems."
          },
          "warranty": {
            "type": "string",
            "description": "The warranty period."
          }
        }
      }
    }
  }
}
